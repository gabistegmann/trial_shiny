[{"name":"app.R","content":"library(shiny)\nlibrary(datasets)\nlibrary(ggplot2)\nlibrary(dplyr)\n\n# Data pre-processing ----\n# Tweak the \"am\" variable to have nicer factor labels -- since this\n# doesn't rely on any user inputs, we can do this once at startup\n# and then use the value throughout the lifetime of the app\n# mpgData <- read.csv(\"/Users/gabistegmann/Library/CloudStorage/GoogleDrive-gabistegmann@gmail.com/My Drive/Personal/R Learning/Shiny Apps/shiny_app_04 - dummy data play/dummy_data.csv\")\n\nid = c(1, 1, 1, 2, 2, 2, 3, 3, 3, 4, 4, 4)\ndisease = c(0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1)\nartp = rnorm(length(id))\nsp_rate = rnorm(length(id))\n\nmpgData = cbind.data.frame(id, disease, artp, sp_rate)\n\n# Define UI for miles per gallon app ----\nui <- fluidPage(\n  \n  # App title ----\n  titlePanel(\"Boxplots for SpeechFeatures\"),\n  \n  # Sidebar layout with input and output definitions ----\n  sidebarLayout(\n    \n    # Sidebar panel for inputs ----\n    sidebarPanel(\n      \n      # Input: Selector for variable to plot against mpg ----\n      selectInput(\"variable\", \"Variable:\",\n                  c(\"Speaking Rate\" = \"sp_rate\",\n                    \"Artic. Prec.\" = \"artp\")),\n      \n      selectInput(\"participant\", \"Participant:\",\n                  c(\"Part. 1\" = 1,\n                    \"Part. 2\" = 2,\n                    \"Part. 3\" = 3,\n                    \"Part. 4\" = 4,\n                    \"Part. 5\" = 5)),\n      \n      # Input: Checkbox for whether outliers should be included ----\n      checkboxInput(\"outliers\", \"Show outliers\", TRUE)\n      \n    ),\n    \n    # Main panel for displaying outputs ----\n    mainPanel(\n      \n      # Output: Formatted text for caption ----\n      h3(textOutput(\"caption\")),\n      \n      # Output: Plot of the requested variable against mpg ----\n      plotOutput(\"sp_artp\"),\n      \n      plotOutput(\"box_1\"),\n      \n      plotOutput(\"box_2\")\n      \n    )\n  )\n)\n\n# Define server logic to plot various variables against mpg ----\nserver <- function(input, output) {\n  \n  # Compute the formula text ----\n  # This is in a reactive expression since it is shared by the\n  # output$caption and output$mpgPlot functions\n  formulaText <- reactive({\n    paste(input$variable, \"~ as.factor(disease)\")\n  })\n  \n  # Return the formula text for printing as a caption ----\n  output$caption <- renderText({\n    formulaText()\n  })\n  \n  \n  # Generate a plot of the requested variable against mpg ----\n  # and only exclude outliers if requested\n  output$sp_artp <- renderPlot({\n    boxplot(as.formula(formulaText()),\n            data = mpgData,\n            outline = input$outliers,\n            col = \"#75AADB\", pch = 19)\n  })\n  \n  output$box_1 <- renderPlot({\n    ggplot(mpgData, aes(x = sp_rate, y = artp)) + geom_point()\n  })\n  \n  \n  \n  output$box_2 <- renderPlot({\n    \n    data_participants = mpgData %>%\n      filter(id %in% input$participant)\n    \n    ggplot(data_participants, aes(x = sp_rate, y = artp)) + geom_point()\n  })\n  \n}\n\n# Create Shiny app ----\nshinyApp(ui, server)\n","type":"text"}]
